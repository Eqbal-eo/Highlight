# مستخرج النصوص المحددة من PDF

برنامج Python لاستخراج النصوص المحددة باللون الأصفر (highlighted) من ملفات PDF وحفظها في ملفات نصية أو Word.

## المميزات

- ✅ استخراج النصوص المحددة باللون الأصفر من ملفات PDF
- ✅ واجهة مستخدم رسومية سهلة الاستخدام
- ✅ نسخة مبسطة لسطر الأوامر
- ✅ حفظ النتائج في ملفات نصية (.txt)
- ✅ حفظ النتائج في ملفات Word (.docx)
- ✅ عرض رقم الصفحة لكل نص مستخرج
- ✅ دعم اللغة العربية كاملاً

## المتطلبات

- Python 3.7 أو أحدث
- المكتبات المطلوبة (موجودة في `requirements.txt`):
  - PyMuPDF (fitz)
  - python-docx
  - tkinter (مدمجة مع Python)

## التثبيت

1. تأكد من تثبيت Python على جهازك
2. قم بتثبيت المكتبات المطلوبة:

```bash
pip install -r requirements.txt
```

أو:

```bash
pip install PyMuPDF python-docx
```

## الاستخدام

### الطريقة الأولى: الواجهة الرسومية

قم بتشغيل البرنامج مع الواجهة الرسومية:

```bash
python pdf_highlight_extractor.py
```

### الطريقة الثانية: سطر الأوامر

قم بتشغيل النسخة المبسطة من سطر الأوامر:

```bash
python simple_extractor.py path/to/your/file.pdf
```

أو مع تحديد ملف الإخراج:

```bash
python simple_extractor.py path/to/your/file.pdf output.txt
```

## طريقة العمل

1. **اختيار الملف**: حدد ملف PDF الذي تريد استخراج النصوص منه
2. **الاستخراج**: اضغط على زر "استخراج النصوص المحددة"
3. **العرض**: ستظهر النصوص المستخرجة في منطقة النتائج
4. **الحفظ**: احفظ النتائج كملف نصي أو Word

## الملفات

- `pdf_highlight_extractor.py`: البرنامج الرئيسي مع الواجهة الرسومية
- `simple_extractor.py`: نسخة مبسطة لسطر الأوامر
- `requirements.txt`: قائمة المكتبات المطلوبة

## المميزات التقنية

### استخراج النصوص
- يتعرف البرنامج على التحديدات (annotations) في ملف PDF
- يستخرج النصوص من المناطق المحددة
- يتحقق من لون التحديد للتأكد من أنه أصفر

### اكتشاف اللون الأصفر
- يتحقق البرنامج من قيم RGB للتحديد
- يعتبر التحديد أصفراً إذا كانت قيم الأحمر والأخضر مرتفعة والأزرق منخفض
- القيم المقبولة: R > 0.7, G > 0.7, B < 0.3

### حفظ النتائج
- **ملف نصي**: تنسيق بسيط مع رقم الصفحة ومعلومات الملف
- **ملف Word**: تنسيق منظم مع عناوين وتنسيق احترافي

## أمثلة الاستخدام

### مثال 1: واجهة رسومية
```bash
python pdf_highlight_extractor.py
```
1. اضغط "تصفح" لاختيار ملف PDF
2. اضغط "استخراج النصوص المحددة"
3. اعرض النتائج واحفظها حسب الحاجة

### مثال 2: سطر الأوامر
```bash
# استخراج مع عرض النتائج فقط
python simple_extractor.py document.pdf

# استخراج مع حفظ النتائج
python simple_extractor.py document.pdf extracted_highlights.txt
```

## إصلاح المشاكل الشائعة

### لا يتم اكتشاف النصوص المحددة
- تأكد من أن التحديد باللون الأصفر
- تجرب أنواع تحديد مختلفة في PDF
- تأكد من أن الملف يحتوي على نصوص قابلة للاستخراج

### مشاكل في التثبيت
```bash
# إذا كانت هناك مشاكل مع PyMuPDF
pip install --upgrade PyMuPDF

# إذا كانت هناك مشاكل مع python-docx
pip install --upgrade python-docx
```

### مشاكل في الترميز
- تأكد من حفظ الملفات بترميز UTF-8
- استخدم محرر نصوص يدعم UTF-8

## الدعم والمساعدة

إذا واجهت أي مشاكل أو كان لديك اقتراحات:

1. تأكد من تثبيت جميع المتطلبات
2. تحقق من تنسيق ملف PDF
3. جرب ملفات PDF مختلفة للاختبار

## الترخيص

هذا البرنامج مجاني للاستخدام الشخصي والتعليمي.

## ملاحظات

- يعمل البرنامج بشكل أفضل مع ملفات PDF التي تحتوي على نصوص قابلة للاستخراج
- قد لا يعمل مع ملفات PDF المصورة (scanned PDFs) بدون OCR
- يدعم جميع أنواع الخطوط والترميزات الشائعة

---

**تم تطوير هذا البرنامج لمساعدة الطلاب والباحثين في استخراج النصوص المهمة من ملفات PDF بسهولة.**
